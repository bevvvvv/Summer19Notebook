---
title: "Chapter 2: Polynomial Interpolation"
output:
  pdf_document: 
    toc: true
    toc_depth: 2
    number_sections: true
  html_notebook: default
---

```{r include = FALSE}
# refresh environment
rm(list = ls())
library(dplyr) # utility package for tidyverse
library(tidyverse)
```

# Polynomial Interpolation

In this chapter we study how to interpolate a data set with a polynomial.

**Problem Description**: Given (n+1) points, say(x~i~, y~i~), where i = 0,1,2,...,n, with distinct
x~i~, not necessarily sorted, we want to find a polynomial of degree n:

\[
P_n(x) = a_nx^n + a_{n-1}x^{n-1}+...+a_1x+a_0
\]

such that it interpolates these points, i.e.,

\[
P_n(x)= y_i, i = 0,1,2,...,n
\]

The goal is the determine the coefficients $a_n, a_{n-1},...,a_1,a_0$. Note the total number of data poitns
is 1 larger than the degree of the polynomial.

Why should we do this?

* Find the values between the points for discrete data set
* To approximate a (probably complicated) function by a polynomial
* Then, it is easier to do computations such as derivative, integrations, etc...

## Van Der Monde Matrix Example

Interpolate the given data set with a polynomial of degree 2:

$$
\begin{tabular}{c|c|c|c|}
x$_i$ & 0 & 1 & 2/3\\
y$_i$ & 1 & 0 & 0.5
\end{tabular}
$$

**Answer** Let

\[
P_2(x) = a_2x^2 + a_1x+ a_0
\]

We need to find the coefficients $a_2, a_1, a_0$.
By the interpolating properties, we have 3 equations:

\[x = 0, y = 1 : P_2(0) = a_0 = 1\]
\[x = 1, y = 0 : P_2(1) = a_2+a_1+a_0 = 0\]
\[x = \frac23, y = 0.5 : P_2(\frac23) = (\frac49)a_2+(\frac23)a_1+a_0=0.5\]

Here we have 3 linear equations and 3 unknowns ($a_2, a_1, a_0$).


The equations:

\[a_0 = 1\]
\[a_2 + a_1 = 0\]
\[\frac49a_2+\frac23a_1+a_0=0.5\]

In matrix-vector form:

$$
\left(\begin{array}{ccc} 
0 & 0 & 1\\
1 & 1 & 1\\
\frac49 & \frac23 & 1
\end{array}\right)
\left(\begin{array}{c} 
a_2 \\
a_1 \\
a_0
\end{array}\right) =
\left(\begin{array}{c}
1 \\
0 \\
0.5
\end{array}\right)
$$

Easy to solve in Matlab, or do it by hand:

\[a_2 = -\frac34\]
\[a_1 = -\frac14\]
\[a_0 = 1\]

Then

\[P_2(x) = -\frac34x^2 -\frac14x + 1\]

### The general case

![](./Media/VanDerMondeGeneral.png)

* X: a (n+1) x (n+1) matrix, given (Van Der Monde matrix)
* a: unknown vector, with length (n + 1)
* y: given vector, with length (n + 1)

**Theorem** If x~i~'s are distinct, then X is invertible, therefore a has a unique solution.

In Matlab, the command vander(x), where x is a vector that contains the interpolation points
x = [$x_1, x_2, ...,x_n$], will generate this matrix.

Bad News: X has a very large condition number for large n, therefore not effective to solve if n is large.

## Lagrange Form

Given points: $x_0,x_1,...,x_n$

Define the **cardinal functions** $I_0,I_1,...,I_n:\in P^n$, satisfying the properties

![](./Media/lagrangeProperties.png)

Here $\delta_{ij}$ is called the Kronecker's delta.

Locally supported in discrete sense. The cardinal functions I_i(x) can be written as:

![](./Media/CardinalFuncForm.png)

Lagrange form of the interpolation polynomial can be simply expressed as 

\[P_n(x) = \Sigma I_j(x) * y_i\]

It is easy to check the interpolating property:

\[P_n(x_j) = \Sigma I_i(x_j) * y_i = y_j\]

for every j. (The cardinal function is 1 at x~i~, so y~i~ is multiplied by 1).

**Example 2** Write the Lagrange polynomial for the data

$$
\begin{tabular}{c|c|c|c|}
x$_i$ & 0 & 1 & 2/3\\
y$_i$ & 1 & 0 & 0.5
\end{tabular}
$$

**Answer** We first ocmpute the cardinal functions

\[I_0(x) = \frac{(x-x_1)(x-x_2)}{(x_0-x_1)(x_0-x_2)} = \frac{(x-2/3)(x-1)}{(0-2/3)(0-1)} = \frac32(x - \frac23)(x-1)\]
\[I_1(x) = \frac{(x-x_0)(x-x_2)}{(x_1-x_0)(x_1-x_2)} = \frac{(x-0)(x-1)}{(2/3-0)(2/3-1)} = -\frac92x(x-1) \]
\[I_2(x) = \frac{(x-x_0)(x-x_1)}{(x_2-x_0)(x_2-x_1)} = \frac{(x-0)(x-2/3)}{(1-0)(1-2/3)} = 2x(x-\frac23) \]

so

\[P_2(x) = I_0(x)y_0+I_1(x)y_1+I_2(x)y_2 = \frac32(x - \frac23)(x-1) -\frac92x(x-1)(0.5) + 0 = -\frac34x^2-\frac14+1\]

Pros and cons of Lagrange polynomial:

* (+) Elegant Formula
* (-) Slow to compute, since each cardinal function is different
* (-) Not flexible: if one changes a point x~j~, or add on an additional point x~n+1~, one must recompute all cardinal functions.

## Newton's divided differences

Given a data set:

$$
\begin{tabular}{c|c|c|c|c|}
x$_i$ & x$_0$ & x$_1$ & ... & x$_n$\\
y$_i$ & y$_0$ & y$_1$ & ... & y$_n$
\end{tabular}
$$

We will describe an algorithm in a recursive form.

**Main idea:**

Given $P_k(x)$ that interpolates k + 1 data points {$x_i, y_i$}, i = 0,1,2,...,k,
compute $P_{k+1}(x)$ that interpolates one extra point, {$x_{k+1},y_{k+1}$}, by using P~k~ and adding an extra term

For n = 0, we set $P_0(x) = y_0$. Then $P_0(x_0) = y_0$.

For n = 1, we set

\[P_1(x) = P_0(x) + a_1(x - x_0)\]

where a~1~ is to be determined.

Then, $P_1(x_0) = P_0(x_0) + 0 = y_0$, for any a~1~.

Find a~1~ by the interpolation property $y_1 = P_1(x_1)$, we have

\[y_1 = P_0(x_1) +a_1(x_1-x_0)=y+0+a_1(x_1-x_0)\]

This gives us 

\[a_1 = \frac{y_1 - y_0}{x_1-x_0}\]

For n = 2, we set

\[P_2(x) = P_1(x) + a_2(x-x_0)(x-x_1)\]

Then $P_2(x_0) = P_1(x_0) = y_0, P_2(x_1) = P_1(x_1) = y_1$.

Determine a~2~ by the interpolation property $y_2 = P_2(x_2)$

\[y_2 = P_1(x_2) + a_2(x_2 - x_0)(x_2-x_1)\]

Then

\[a_2 = \frac{y_2 - P_1(x_2)}{(x_2-x_0)(x_2-x_1)}\]

We would like to express a~2~ in a different way. Recall

\[P_1(x) = y_0 + \frac{y_1-y_0}{x_1-x_0}(x - x_0)\]

Then 

\[P_1(x_2) = y_0 + \frac{y_1-y_0}{x_1-x_0}(x_2 - x_0)\]
\[P_1(x_2) = y_0 + \frac{y_1-y_0}{x_1-x_0}(x_2 - x_1) + \frac{y_1-y_0}{x_1-x_0}(x_1 - x_0)\]
\[P_1(x_2) = y_1 + \frac{y_1-y_0}{x_1-x_0}(x_2 - x_1)\]

Then a~2~ can be rewritten as

\[a_2 = \frac{y_2 - {P_1(x_2)}}{(x_2-x_0)(x_2-x_1)} = \frac{y_2-y_1-\frac{y_1-y_0}{x_1-x_0}(x_2-x_1)}{(x_2-x_0)(x_2-x_1)}=\frac{\frac{y_2-y_1}{x_2-x_1}-\frac{y_1-y_0}{x_1-x_0}}{x_2-x_0}\]


(Rise over the run? Secant lines represented...)

\[a_2 \approx \frac{f'(x_2)-f'(x_0)}{x_2-x_0} \approx f''()\]

and a_1 is an approximate first derivative.

### The general case:

![](./Media/newtonDivideGeneral.png)


Newton's form for the interpolation polynomial:

\[P_n(x) = a_0 + a_1(x - x_0) + a_2(x-x_0)(x-x_1)+...+a_n(x-x_0)(x-x_1)...(x-x_{n-1})\]




